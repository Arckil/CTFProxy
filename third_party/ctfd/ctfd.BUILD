load("@ctfd_pip//:requirements.bzl", "requirement")
load("@rules_python//python:defs.bzl", "py_library")

exports_files(glob(["**/*"]))

py_library(
    name = "app_lib",
    srcs = glob([
        "CTFd/**/*.py",
        "migrations/**/*.py",
    ]),
    data = glob(
        [
            "CTFd/**",
        ],
        exclude = [
            "CTFd/**/*.py",
        ],
    ),
    visibility = ["@ctfproxy//infra/ctfd:__pkg__"],
    deps = [
        requirement("alembic"),
        requirement("aniso8601"),
        requirement("asn1crypto"),
        requirement("attrs"),
        requirement("bcrypt"),
        requirement("boto3"),
        requirement("botocore"),
        requirement("certifi"),
        requirement("cffi"),
        requirement("chardet"),
        requirement("click"),
        requirement("configparser"),
        requirement("contextlib2"),
        requirement("cryptography"),
        requirement("dataset"),
        requirement("docutils"),
        requirement("enum34"),
        requirement("Flask"),
        requirement("Flask-Caching"),
        requirement("flask-marshmallow"),
        requirement("Flask-Migrate"),
        requirement("flask-restx"),
        requirement("Flask-Script"),
        requirement("Flask-SQLAlchemy"),
        requirement("functools32"),
        requirement("futures"),
        requirement("gevent"),
        requirement("greenlet"),
        requirement("gunicorn"),
        requirement("idna"),
        requirement("importlib-metadata"),
        requirement("ipaddress"),
        requirement("itsdangerous"),
        requirement("Jinja2"),
        requirement("jmespath"),
        requirement("jsonschema"),
        requirement("Mako"),
        requirement("MarkupSafe"),
        requirement("marshmallow"),
        requirement("marshmallow-sqlalchemy"),
        requirement("mistune"),
        requirement("netaddr"),
        requirement("passlib"),
        requirement("pathlib2"),
        requirement("pycparser"),
        requirement("PyJWT"),
        requirement("PyMySQL"),
        requirement("pyrsistent"),
        requirement("python-dateutil"),
        requirement("python-dotenv"),
        requirement("python-editor"),
        requirement("pytz"),
        requirement("redis"),
        requirement("requests"),
        requirement("s3transfer"),
        requirement("scandir"),
        requirement("six"),
        requirement("SQLAlchemy"),
        requirement("SQLAlchemy-Utils"),
        requirement("typing"),
        requirement("urllib3"),
        requirement("Werkzeug"),
        requirement("zipp"),
    ],
)
